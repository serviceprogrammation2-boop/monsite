<!DOCTYPE html>
<html>

<head>
    <title>Liste des Lignes</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>

<body class="p-4">

    {% block content %}
    <h1>Liste des lignes</h1>

    <!-- ===== Formulaire de filtrage ===== -->
    <form method="get" action="" style="margin-bottom: 20px;">
        <label for="code">Code :</label>
        <input type="text" name="code" id="code" value="{{ code }}" placeholder="Code de la ligne">

        <label for="agence">Agence :</label>
        <input type="text" name="agence" id="agence" value="{{ agence }}" placeholder="Agence">

        <label for="actif">Actif :</label>
        <select name="actif" id="actif">
            <option value="" {% if not actif %}selected{% endif %}>-- Tous --</option>
            <option value="1" {% if actif_true %}selected{% endif %}>Oui</option>
            <option value="0" {% if actif_false %}selected{% endif %}>Non</option>
        </select>

        <button type="submit" class="btn btn-primary">Filtrer</button>
    </form>

    <!-- ===== Bouton PDF sÃ©parÃ© ===== -->
    <form method="get" action="{% url 'ligne_pdf' %}" target="_blank" style="margin-bottom: 20px;">
        <input type="hidden" name="code" value="{{ code }}">
        <input type="hidden" name="agence" value="{{ agence }}">
        <input type="hidden" name="actif" value="{{ actif }}">
        <button type="submit" class="btn btn-danger">
            ðŸ“„ Exporter en PDF
        </button>
    </form>

    <!-- ===== Tableau des lignes ===== -->
    <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle">
            <thead class="table-dark text-center">
                <tr>
                    <th>Code</th>
                    <th>Origine</th>
                    <th>Destination</th>
                    <th>Agence</th>
                    <th>KLM</th>
                    <th>Actif</th>
                </tr>
            </thead>
            <tbody>
                {% for ligne in lignes %}
                <tr>
                    <td>{{ ligne.code }}</td>
                    <td>{{ ligne.origine }}</td>
                    <td>{{ ligne.dest }}</td>
                    <td>{{ ligne.agence }}</td>
                    <td>{{ ligne.klm }}</td>
                    <td>{% if ligne.actif %}Oui{% else %}Non{% endif %}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">Aucune ligne trouvÃ©e.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ===== Pagination ===== -->
    <div style="margin-top: 20px;">
        {% if page_obj.has_previous %}
        <a
            href="?page=1{% if code %}&code={{ code }}{% endif %}{% if agence %}&agence={{ agence }}{% endif %}{% if actif %}&actif={{ actif }}{% endif %}">Â«
            PremiÃ¨re</a>
        <a
            href="?page={{ page_obj.previous_page_number }}{% if code %}&code={{ code }}{% endif %}{% if agence %}&agence={{ agence }}{% endif %}{% if actif %}&actif={{ actif }}{% endif %}">â€¹
            PrÃ©cÃ©dente</a>
        {% endif %}

        Page {{ page_obj.number }} sur {{ page_obj.paginator.num_pages }}

        {% if page_obj.has_next %}
        <a
            href="?page={{ page_obj.next_page_number }}{% if code %}&code={{ code }}{% endif %}{% if agence %}&agence={{ agence }}{% endif %}{% if actif %}&actif={{ actif }}{% endif %}">Suivante
            â€º</a>
        <a
            href="?page={{ page_obj.paginator.num_pages }}{% if code %}&code={{ code }}{% endif %}{% if agence %}&agence={{ agence }}{% endif %}{% if actif %}&actif={{ actif }}{% endif %}">DerniÃ¨re
            Â»</a>
        {% endif %}
    </div>

    {% endblock %}

</body>

</html>